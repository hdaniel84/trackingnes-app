spring:
  application:
    name: trackingnes-app

  # 1. DATASOURCE & POOL (HikariCP)
  datasource:
    #  SEGURIDAD: Usa variables de entorno, no hardcodees contrase帽as
    url: jdbc:mysql://${DB_HOST}:${DB_PORT:3306}/${MYSQL_DATABASE:tracking_db}?serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true
    username: ${DB_USER}
    password: ${DB_PASSWORD}   
    driverClassName: com.mysql.cj.jdbc.Driver
    
    # Configuraci贸n del Pool (Rendimiento y Estabilidad)
    hikari:
      pool-name: TrackingNesHikariCP
      minimum-idle: 5                # Conexiones m铆nimas siempre listas
      maximum-pool-size: 20          # M谩ximo de conexiones simult谩neas (ajustar seg煤n RAM de BD)
      idle-timeout: 300000           # 5 min (tiempo para cerrar conexi贸n inactiva)
      max-lifetime: 1800000          # 30 min (tiempo m谩ximo de vida de una conexi贸n)
      connection-timeout: 20000      # 20 seg (tiempo m谩ximo espera para obtener conexi贸n)
      validation-timeout: 5000       # 5 seg para validar conexi贸n
      test-on-borrow: false          # Hikari lo maneja mejor internamente, dejar en false por performance

  # 2. JPA & HIBERNATE
  jpa:
    #  CRTICO ENTERPRISE: Cierra la sesi贸n tras el Service. 
    # Evita el antipatr贸n "LazyInitializationException" en la vista y queries n+1 ocultas.
    open-in-view: false              
    
    # En Producci贸n: 'validate' o 'none'. NUNCA 'update'.
    hibernate:
      ddl-auto: validate             
    
    show-sql: false                  # False en producci贸n (seguridad y logs limpios)
    
    properties:
      hibernate:
        # Dialecto Espec铆fico (Optimiza SQL para MySQL 8)
        #dialect: org.hibernate.dialect.MySQL8Dialect
        
        # Formato (Solo 煤til en dev, false en prod para ahorrar CPU en logs)
        format_sql: false            
        
        #  PERFORMANCE (Batching)
        # Permite insertar/actualizar 50 trackings en 1 viaje a la BD en lugar de 50 viajes.
        jdbc:
          batch_size: 50
          fetch_size: 50             # Trae 50 registros a la memoria de golpe en select grandes
        order_inserts: true
        order_updates: true
        
        # Generaci贸n de Estad铆sticas (煤til para debug, apagar en prod)
        generate_statistics: false

server:
  port: 8080 
  # Configuraci贸n segura de timeouts del servidor web
  tomcat:
    connection-timeout: 20000
    max-threads: 200
    min-spare-threads: 10

jwt:
  # Usa una variable de entorno para el secret en producci贸n
  secret: ${JWT_SECRET:N1DV4fjxISpoZUMg0EWdWvH8p5butUZmDZYmbFZZ1EVOYNmtrzBxc5oVUlPmpNia}